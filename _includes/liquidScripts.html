<!-- Showcase grid display and load more posts button -->
<script>
    var postsPerPage = 9;

    var loadButton = document.getElementById("loadShowcaseBtn");

    var showcaseGrid = document.getElementById("showcaseGrid");


    {% assign showcaselist = site.posts | where:"category", "showcase"%}
    var showcaseIndex=[
        {% for post in showcaselist %}
            {
                date: "{{ post.date | date: "%d %b %Y"}}",
                title: "{{post.title}}",
                videoUrl: "{{post.preview-video}}",
                url: "{{ site.baseurl }}{{ post.url }}"
            }{% unless forloop.last %},{% endunless %}
        {% endfor %}
    ];
    
    var pageLimit = Math.min(showcaseIndex.length, postsPerPage);
    for(i = 0; i < pageLimit; i++){
        addPostPreview(i);
    }

    var previousLimit = pageLimit;
    function increasePageLimit() {
        pageLimit += postsPerPage;
        pageLimit = Math.min(pageLimit, showcaseIndex.length);

        for(j = previousLimit; j < pageLimit; j++)
        {
            addPostPreview(j);
        }
        previousLimit = pageLimit;

        if(pageLimit == showcaseIndex.length)
        {
            loadButton.style.visibility = "hidden";
            loadButton.style.opacity = 0;
        }
    }

    function addPostPreview(i){
        var showcaseContainer = document.createElement('div');
        showcaseContainer.classList.add('container__preview', 'round');
        showcaseGrid.appendChild(showcaseContainer);

        var post = showcaseIndex[i];
        
        if(post.videoUrl != "")
        {
            var videoLink = document.createElement('a');
            videoLink.href = post.url;
            
            var videoContainer = document.createElement('div');
            videoContainer.classList.add('container__preview-video');

            var video = document.createElement('video');
            video.src = "/" + post.videoUrl;
            video.autoplay = true;
            video.muted = true;
            video.loop = true;
            video.classList.add('round');

            videoContainer.appendChild(video);
            videoLink.appendChild(videoContainer);
            showcaseContainer.appendChild(videoLink);
        }
        else
        {
            var emptyContainer = document.createElement('div');
            emptyContainer.classList.add('container__preview-video');
            emptyContainer.style.paddingTop = "100%";
            showcaseContainer.appendChild(emptyContainer);
        }
        


        var captionLink = document.createElement('a');
        captionLink.href = post.url;
        captionLink.classList.add('caption__text', 'round');

        var captionText = document.createTextNode(post.title);

        captionLink.appendChild(captionText);

        var date = document.createElement('div');
        date.innerHTML = post.date;
        date.style.fontSize= "small";
        captionLink.appendChild(date);

        showcaseContainer.appendChild(captionLink);
    }
</script>